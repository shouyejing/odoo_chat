<?xml version="1.0"?>
<openerp>
    <data>
    
        <menuitem name="SMS Gateway" id="menu_smsclient_administration_server" parent="base.menu_config"/>
        
        <!-- SMS Gateway list -->
        
        <record id="act_to_sms_gateway_2_history" model="ir.actions.act_window">
			<field name="name">SMS History</field>
			<field name="res_model">sms.smsclient.history</field>
			<field name="view_type">form</field>
			<field name="view_mode">tree,form</field>
			<field name="context">{'search_default_gateway_id': active_id}</field>			
		</record>
		
		<record id="act_to_sms_gateway_2_queue" model="ir.actions.act_window">
			<field name="name">Message Queue</field>
			<field name="res_model">sms.smsclient.queue</field>
			<field name="view_type">form</field>
			<field name="view_mode">tree,form</field>
			<field name="context">{'search_default_gateway_id': active_id}</field>			
		</record>
        
        <record model="ir.ui.view" id="sms_smsclient_form">
            <field name="name">sms.smsclient.form</field>
            <field name="model">sms.smsclient</field>
            <field name="priority" eval="8"/>
            <field name="arch" type="xml">
                <form string="SMS Gateway">
                    <sheet>
                    	<div class="oe_title">
							<label for="name" class="oe_edit_only"/>
		                    <h1>
		                        <field name="name"/>
		                    </h1>
						</div>
						<div class="oe_right oe_button_box" name="buttons">
							<button class="oe_inline oe_stat_button" type="action"
								name="%(act_to_sms_gateway_2_history)d"
								icon="fa-history" string="SMS History">
							</button>
							<button class="oe_inline oe_stat_button" type="action"
								name="%(act_to_sms_gateway_2_queue)d"
								icon="fa-inbox" string="SMS Queue">
							</button>
						</div>                    	
                    	<group>
	                    	<group>	                    		
	                    		<field name="url"/>	
	                    	</group>
	                    	<group>
	                    		<field name="method"/>                   				
	                    	</group>
                    	</group>
	                    <notebook colspan="4">
	                        <page string="General">
	                            <field name="property_ids" nolabel="1">
	                                <tree string="Gateway Parameters">
	                                    <field name="type"/>
	                                    <field name="name"/>
	                                    <field name="value"/>
	                                </tree>
	                                <form string="Gateway Parameters">
	                                    <group>
	                                    	<field name="type"/>
		                                    <field name="name"/>
		                                    <field name="value"/>
	                                    </group>
	                                </form>
	                            </field>
	                            <field name="state" invisible="1"/>
	                        </page>
	                        <page string="Access Permission">
	                            <field name="users_id" nolabel="1" />
	                        </page>
	                        <page string="Additional option">
	   		                	<group>	  	 	
		           		          	<group>
		   		          	        	<field name="validity"/>
		   		          	        	<field name="classes"/>
		   		          	        	<field name="deferred"/>
		   		          	        	<field name="nostop"/>
		           		          	</group>
		   		          	        <group>
			                   			<field name="priority"/>
			                   			<field name="coding"/>
			                   			<field name="tag"/>
			                   			<field name="char_limit"/>
									</group>
								</group>
							</page>
	                    </notebook>
                    </sheet>
                </form>
            </field>
        </record>

        <record model="ir.ui.view" id="sms_smsclient_tree">
            <field name="name">sms.smsclient.tree</field>
            <field name="model">sms.smsclient</field>
            <field name="priority" eval="8"/>
            <field name="arch" type="xml">
                <tree string="SMS Gateways">
                    <field name="name" select="1"/>
                    <field name="method" select="1"/>
                    <field name="url"/>
                    <field name="property_ids"/>
                </tree>
            </field>
        </record>

        <record model="ir.actions.act_window" id="action_sms_smsclient_tree">
            <field name="name">SMS Gateway</field>
            <field name="res_model">sms.smsclient</field>
            <field name="view_type">form</field>
            <field name="view_mode">form,tree</field>
            <field name="view_id" ref="sms_smsclient_tree" />
        </record>

        <menuitem name="Gateway List" id="menu_smsclient_administration_sms_server" sequence="1"
        	parent="menu_smsclient_administration_server" action="action_sms_smsclient_tree"/>
        
        <!-- History of sending message -->
        
        <record model="ir.ui.view" id="sms_smsclient_history_tree">
            <field name="name">sms.smsclient.history.tree</field>
            <field name="model">sms.smsclient.history</field>
            <field name="arch" type="xml">
                <tree string="Gateway History" create="0" edit="0">
                    <field name="date_create"/>
                    <field name="user_id"/>
                    <field name="name"/>
                    <field name="gateway_id"/>
                    <field name="partner_id"/>
                    <field name="to"/>
                    <field name="sms"/>
                </tree>
            </field>
        </record>

        <record model="ir.ui.view" id="sms_smsclient_history_form">
            <field name="name">sms.smsclient.history.form</field>
            <field name="model">sms.smsclient.history</field>
            <field name="arch" type="xml">
                <form string="Gateway History" create="0" edit="0">
                    <group>
                    	<group>
                    		<field name="gateway_id"/>
                   			<field name="user_id" select="1"/>	
                    	</group>
                    	<group>
                    		<field name="date_create" select="1"/>
                   			<field name="name" select="1"/>
                   			<field name="to" select="1"/>		
                    	</group>
                    </group>
                    <separator string="SMS Message"/>
                    <field name="sms"/>
                    <separator string="Return Message"/>
                    <field name="return_msg"/>
                </form>
            </field>
        </record>
        
        <record id="sms_smsclient_history_search" model="ir.ui.view">
			<field name="name">sms.smsclient.history.search</field>
			<field name="model">sms.smsclient.history</field>
			<field name="arch" type="xml">
				<search string="Gateway History">
					<field name="partner_id" string="Partner" />
					<field name="gateway_id" string="Gateway" />
					<field name="to" string="Phone" />
					<field name="sms" string="SMS Message" />
					<group expand="0" string="Group By">
						<filter string="Gateway" domain="[]" context="{'group_by':'gateway_id'}" />
						<filter string="Partner" domain="[]" context="{'group_by':'partner_id'}" />
						<filter string="Phone" domain="[]" context="{'group_by':'to'}" />
						<separator/>
						<filter string="Date" domain="[]" context="{'group_by':'date_create'}" />
					</group>
				</search>
			</field>
		</record>

        <record model="ir.actions.act_window" id="action_sms_smsclient_history_tree">
            <field name="name">SMS History</field>
            <field name="res_model">sms.smsclient.history</field>
            <field name="view_type">form</field>
            <field name="view_mode">form,tree</field>
            <field name="view_id" ref="sms_smsclient_history_tree" />
        </record>

        <menuitem name="SMS History" id="menu_smsclient_administration_sms_server_history" sequence="2"
        	parent="menu_smsclient_administration_server" action="action_sms_smsclient_history_tree"/>        
        
        <!-- Message queue -->
        
        <record model="ir.ui.view" id="sms_smsclient_message_queue_tree">
            <field name="name">sms.smsclient.queue.tree</field>
            <field name="model">sms.smsclient.queue</field>
            <field name="arch" type="xml">
                <tree string="Message Queue" create="0" edit="0">
                    <field name="date_create"/>
                    <field name="partner_id"/>
                    <field name="mobile"/>
                    <field name="msg"/>
                    <field name="state"/>
                    <field name="gateway_id"/>
                </tree>
            </field>
        </record>

        <record model="ir.ui.view" id="sms_smsclient_message_queue_form">
            <field name="name">sms.smsclient.history.form</field>
            <field name="model">sms.smsclient.queue</field>
            <field name="arch" type="xml">
                <form string="Gateway History" create="0" edit="0">
                	<group>
                		<group>
                			<field name="gateway_id"/>
                			<field name="mobile"/>		
                		</group>
                		<group>
                			<field name="date_create"/>
                			<field name="state"/>	
                		</group>
                	</group>
                	<separator string="SMS Message" colspan="4"/>
                    <field name="msg" colspan="4" select="2" nolabel="1"/>
                    <separator string="Last Error"  colspan="4"/>
                    <field name="error" colspan="4" select="2" nolabel="1"/>
                </form>
            </field>
        </record>        

        <record model="ir.actions.act_window" id="action_sms_smsclient_queue_tree">
            <field name="name">Message Queue</field>
            <field name="res_model">sms.smsclient.queue</field>
            <field name="view_type">form</field>
            <field name="view_mode">form,tree</field>
            <field name="view_id" ref="sms_smsclient_message_queue_tree" />
        </record>

        <menuitem name="Message Queue" id="menu_smsclient_administration_sms_server_queue" sequence="3"
        	parent="menu_smsclient_administration_server" action="action_sms_smsclient_queue_tree"/>

    </data>
</openerp>
